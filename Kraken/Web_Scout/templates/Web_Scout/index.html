{% extends "base.html" %}
{% block head %}
	<script>
	$(document).ready(function(){

	loadGallery(true, 'a.thumbnail');

	//This function disables buttons when needed
	function disableButtons(counter_max, counter_current){
		$('#show-previous-image, #show-next-image').show();
		if(counter_max == counter_current){
			$('#show-next-image').hide();
		} else if (counter_current == 1){
			$('#show-previous-image').hide();
		}
	}

	/**
	 *
	 * @param setIDs		Sets IDs when DOM is loaded. If using a PHP counter, set to false.
	 * @param setClickAttr  Sets the attribute for the click handler.
	 */

	function loadGallery(setIDs, setClickAttr){
		var current_image,
			selector,
			counter = 0;

		$('#show-next-image, #show-previous-image').click(function(){
			if($(this).attr('id') == 'show-previous-image'){
				current_image--;
			} else {
				current_image++;
			}

			selector = $('[data-image-id="' + current_image + '"]');
			updateGallery(selector);
		});



		function updateGallery(selector) {
			var $sel = selector;
			current_image = $sel.attr('data-image-id');
			$('#image-gallery-name').text($sel.attr('data-name'));
			$('#image-gallery-title').text($sel.attr('data-title'));
			$('#image-gallery-image').attr('src', $sel.attr('data-image'));
			$('#image-gallery-link').attr('href', $sel.attr('data-link'));
			$('#image-gallery-extlink').attr('href', $sel.attr('data-link')+'&external=true');
			$('#image-gallery-category').text($sel.attr('data-category'));
			$('#image-gallery-lastseen').text($sel.attr('data-lastseen'));
			$('#image-gallery-product').text($sel.attr('data-product'));
			$('#image-gallery-note').val('');
			$('#image-gallery-note').val($sel.attr('data-note'));
			$('#image-gallery-id').attr('value', $sel.attr('id'));
			$('#image-gallery-host-id').attr('value', $sel.attr('data-host-id'));
			if($sel.attr('data-default-creds') == "True"){
				$("#image-gallery-default-creds").prop("checked", true);
			}else{
				$("#image-gallery-default-creds").prop("checked", false);
			}
			if($sel.attr('data-http-auth') == "True"){
				$("#image-gallery-http-auth").prop("checked", true);
			}else{
				$("#image-gallery-http-auth").prop("checked", false);
			}
			if($sel.attr('data-reviewed') == "True"){
				$("#image-gallery-reviewed").prop("checked", true);
			}else{
				$("#image-gallery-reviewed").prop("checked", false);
			}
			if($sel.attr('data-module') == "True"){
				$("#runmodule").attr('data-id', $sel.attr('id'));
				$("#runmodule")[0].style.display = 'inline';
			}else{
				$("#runmodule")[0].style.display = 'none';
			}
			disableButtons(counter, $sel.attr('data-image-id'));
		}

		if(setIDs == true){
			$('[data-image-id]').each(function(){
				counter++;
				$(this).attr('data-image-id',counter);
			});
		}

		$(document).keydown(function(e) {
   			switch(e.which) {
				case 37: // left
				if (current_image > 1){
					current_image--;
				}
				selector = $('[data-image-id="' + current_image + '"]');
				updateGallery(selector);
				break;

				case 39: // right
				if (current_image < counter){
					current_image++;
				}
				selector = $('[data-image-id="' + current_image + '"]');
				updateGallery(selector);
				break;

				case 38: // up
				document.getElementById('image-gallery-link').click();
				break;

				default: return; // exit this handler for other keys
			}
			e.preventDefault(); // prevent the default action (scroll / move caret)
		});

		$(setClickAttr).on('click',function(){
			updateGallery($(this));
		});
	}
	});
	</script>

	<style>
		.advsearch{
			display:inline-block;
			padding:6px 12px;
			margin-bottom:0;
			font-size:14px;
			font-weight:400;
			line-height:1.42857143;
			text-align:center;
			white-space:nowrap;
			vertical-align:middle;
			-ms-touch-action:manipulation;
			touch-action:manipulation;
			cursor:pointer;
			-webkit-user-select:none;
			-moz-user-select:none;
			-ms-user-select:none;
			user-select:none;
			background-image:none;
			border:1px solid transparent;
			border-radius:4px;
			color:#9D9D9D;
			background-color:#222
			}
		.advsearch.active.focus,
		.advsearch.active:focus,
		.advsearch.focus,
		.advsearch:active.focus,
		.advsearch:active:focus,
		.advsearch:focus{
			outline:5px auto -webkit-focus-ring-color;
			outline-offset:-2px
			}
		.advsearch.focus,
		.advsearch:focus,
		.advsearch:hover{
			color:#FFFFFF;
			text-decoration:none
			}
		.advsearch.active,
		.advsearch:active{
			background-image:none;
			border:none;
			outline:0;
			}
	</style>
{% endblock %}

{% block navbarright %}

<li><button type="button" class="advsearch navbar-btn" data-toggle="collapse" data-target="#filter-panel"><span class="glyphicon glyphicon-cog"></span> Advanced Search</button></li>

{% endblock %}

{% block body %}
<!-- Body Content -->
<div class="center-block" style="width:95%;">
<div class="alert alert-success" id="success-alert" style="z-index:5;position:absolute;width:95%;top:55px">
        <button type="button" class="close" data-dismiss="alert">x</button>
        <strong>Success!</strong>
        <span id="success-text"></span>
</div>
<div class="alert alert-warning" id="warning-alert" style="z-index:5;position:absolute;width:95%;top:55px">
        <button type="button" class="close" data-dismiss="alert">x</button>
        <strong>Warning!</strong>
        <span id="warning-text"></span>
</div>
</div>

<div class="container-fluid">
<div class="container">
	<div class="row">
        <div id="filter-panel" class="collapse filter-panel">
            <div class="panel panel-default" style="background-color:#F5F5F5">
                <div class="panel-body">
                    <form id="filterform" style="text-align:center" class="form-inline" role="form" method="GET">
                        <div class="form-group">
                            <label class="filter-col" style="padding-left:10px;padding-right:10px;" for="pref-perpage">Hosts per page:</label><br>
                            <select id="pref-perpage" class="form-control" name="hosts_per_page">
                                {% if hosts_per_page > 0 %}
                                	{% if hosts_per_page == 20 %}
                                		<option selected="selected" value="20">20</option>
                                	{% else %}
                                		<option value="20">20</option>
                                	{% endif %}
                                	{% if hosts_per_page == 30 %}
                                		<option selected="selected" value="30">30</option>
                                	{% else %}
                                		<option value="30">30</option>
                                	{% endif %}
                                	{% if hosts_per_page == 40 %}
                                		<option selected="selected" value="40">40</option>
                                	{% else %}
                                		<option value="40">40</option>
                                	{% endif %}
                                	{% if hosts_per_page == 50 %}
                                		<option selected="selected" value="50">50</option>
                                	{% else %}
                                		<option value="50">50</option>
                                	{% endif %}
                                	{% if hosts_per_page == 100 %}
                                		<option selected="selected" value="100">100</option>
                                	{% else %}
                                		<option value="100">100</option>
                                	{% endif %}
                                {% else %}
                                	<option selected="selected" value="20">20</option>
                                	<option value="30">30</option>
                                	<option value="40">40</option>
                                	<option value="50">50</option>
                                	<option value="100">100</option>
                                {% endif %}
                            </select>                                
                        </div> <!-- form group [hosts] -->
                        <div class="form-group">
                            <label class="filter-col" style="margin-right:0;" for="pref-search">Search:</label><br>
                            <input type="text" class="form-control input-sm" id="pref-search" name="search" value="{{ search }}">
                        </div><!-- form group [search] -->
                        <div class="form-group" style="padding-left:15px">
                            <label class="filter-col" style="margin-right:0;" for="pref-orderby">Order by:</label><br>
                            <select id="pref-orderby" class="form-control" name="organize_by">
                                {% if not org == 'IP' %}
                                	<option>IP</option>
                                	{% if org == 'Hostname' %}
                                		<option selected="selected">Hostname</option>
                                	{% else %}
                                		<option>Hostname</option>
                                	{% endif %}
                                	{% if org == 'Rating' %}
                                		<option selected="selected">Rating</option>
                                	{% else %}
                                		<option>Rating</option>
                                	{% endif %}
                                {% else %}
                                	<option>IP</option>
                                	<option>Hostname</option>
                                	<option>Rating</option>
                                {% endif %}
                            </select>                                
                        </div> <!-- form group [order by] --> 
                        <div class="form-group"> <br>
                           	{% if reviewed == 'on' %}
                           		<div class="checkbox" style="margin-left:10px; margin-right:10px;">
                                	<label>
                                		<br><input type="checkbox" name="hide_reviewed" checked="checked">Hide Reviewed
                                	</label>
                            	</div>
                           	{% else %}
                           		<div class="checkbox" style="margin-left:10px; margin-right:10px;">
                                	<label>
                                		<input type="checkbox" name="hide_reviewed">Hide Reviewed
                        			</label>
                            	</div>
                           	{% endif %}
                        </div>
                        <div class="form-group">
                           	<br>
                            <button type="submit" class="btn btn-default filter-col">
                                <span class="glyphicon glyphicon-filter"></span> Filter
                            </button>
                            <br>  
                        </div>
                        <div class="form-group">
                    		<br>
                    		<a href="{% url 'webscout:index' %}"><button type="button" class="btn btn-default filter-col">
                    			Clear Filter
                    		</button></a>
                    	</div>
                    </form>
                </div>
            </div>
        </div>    
	</div>
</div>
{% if hosts %}

	<!-- Pagination -->
	<nav>
	<div align="center">
        <div class="btn-group" style="position:absolute;left:0px;margin:20px">
            <button type="button" id="checkall" class="btn btn-default">Bulk</button>
            <input type="checkbox" id="flagstone" style="display: none;" />
            <button style="box-sizing: border-box;" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                <span class="caret" style="margin-right:-3px"></span>&#160
    			<span class="sr-only">Toggle Dropdown</span>
            </button>
            <ul class="dropdown-menu">
                <li><a href="" id="bulkreviewed">Reviewed</a></li>
                <li><a href="" id="bulknotes" data-toggle="modal" data-target="#bulk-note-modal">Notes</a></li>
                <li><a href="" id="bulkscreenshot" data-toggle="modal" data-target="#confirm-screenshot-hosts">Screenshot</a></li>
                <li><a href="" id="bulkrunmodule" data-toggle="modal" data-target="#confirm-runmodule-hosts">Test Default Credentials</a></li>
                <li><a href="" id="bulkdelete" data-toggle="modal" data-target="#confirm-delete-hosts">Delete Hosts</a></li>
            </ul>
        </div>
		<ul class="pagination" align="center">		
			{% if hosts.has_previous %}
				<li><a href="?page={{ hosts.previous_page_number }}{{ pagination_parameters }}">&laquo;</a>
			{% endif %}
			{% if hosts.paginator.num_pages < 12 %}
				{% for page in hosts.paginator.page_range %}
					{% if hosts.number == page %}
						<li class="active"><a href="?page={{ page }}{{ pagination_parameters }}"> {{ page }} <span class="sr-only">(current)</span></a></li>
					{% else %}
						<li><a href="?page={{ page }}{{ pagination_parameters }}"> {{ page }} </a></li>
					{% endif %}
				{% endfor %}
			{% elif hosts.paginator.num_pages > 11 %}
				{% if hosts.number < 7 %}
					{% for page in "nnnnnnnnnnn" %}
						{% if hosts.number == forloop.counter %}
							<li class="active"><a href="?page={{ forloop.counter }}{{ pagination_parameters }}"> {{ forloop.counter }} <span class="sr-only">(current)</span></a></li>
						{% else %}
							<li><a href="?page={{ forloop.counter }}{{ pagination_parameters }}"> {{ forloop.counter }} </a></li>
						{% endif %}
					{% endfor %}
				{% elif hosts.number|add:5 <= hosts.paginator.num_pages %}
					<li><a href="?page={{ hosts.previous_page_number|add:"-4" }}{{ pagination_parameters }}"> {{ hosts.previous_page_number|add:"-4" }} </a></li>
					<li><a href="?page={{ hosts.previous_page_number|add:"-3" }}{{ pagination_parameters }}"> {{ hosts.previous_page_number|add:"-3" }} </a></li>
					<li><a href="?page={{ hosts.previous_page_number|add:"-2" }}{{ pagination_parameters }}"> {{ hosts.previous_page_number|add:"-2" }} </a></li>
					<li><a href="?page={{ hosts.previous_page_number|add:"-1" }}{{ pagination_parameters }}"> {{ hosts.previous_page_number|add:"-1" }} </a></li>
					<li><a href="?page={{ hosts.previous_page_number }}{{ pagination_parameters }}"> {{ hosts.previous_page_number }} </a></li>
					<li class="active"><a href="?page={{ hosts.number }}{{ pagination_parameters }}"> {{ hosts.number }} </a></li>
					<li><a href="?page={{ hosts.next_page_number }}{{ pagination_parameters }}"> {{ hosts.next_page_number }} </a></li>
					<li><a href="?page={{ hosts.next_page_number|add:"1" }}{{ pagination_parameters }}"> {{ hosts.next_page_number|add:"1" }} </a></li>	
					<li><a href="?page={{ hosts.next_page_number|add:"2" }}{{ pagination_parameters }}"> {{ hosts.next_page_number|add:"2" }} </a></li>
					<li><a href="?page={{ hosts.next_page_number|add:"3" }}{{ pagination_parameters }}"> {{ hosts.next_page_number|add:"3" }} </a></li>
					<li><a href="?page={{ hosts.next_page_number|add:"4" }}{{ pagination_parameters }}"> {{ hosts.next_page_number|add:"4" }} </a></li>
				{% elif hosts.number|add:5 > hosts.paginator.num_pages %}
					{% for minus_number in nav_list %}
						{% if hosts.number == hosts.paginator.num_pages|add:minus_number %}
							<li class="active"><a href="?page={{ hosts.paginator.num_pages|add:minus_number }}{{ pagination_parameters }}"> {{ hosts.paginator.num_pages|add:minus_number }} </a></li>
						{% else %}
							<li><a href="?page={{ hosts.paginator.num_pages|add:minus_number }}{{ pagination_parameters }}"> {{ hosts.paginator.num_pages|add:minus_number }} </a></li>
						{% endif %}	
					{% endfor %}
					{% if hosts.paginator.num_pages == hosts.number %}
						<li class="active"><a href="?page={{ hosts.paginator.num_pages }}{{ pagination_parameters }}"> {{ hosts.paginator.num_pages }} </a></li>
					{% else %}
						<li><a href="?page={{ hosts.paginator.num_pages }}{{ pagination_parameters }}"> {{ hosts.paginator.num_pages }} </a></li>
					{% endif %}
				{% endif %}
			{% endif %}
						{% if hosts.has_next %}
								<li><a href="?page={{ hosts.next_page_number }}{{ pagination_parameters }}">&raquo;</a>
						{% endif %}

		</ul>			
	</div>
	</nav>


	
	<!-- List of screenshots -->
	<form id="delete-host-form" name="delete-host-form">
	{% csrf_token %}
	<input type="hidden" class="form-control" name="action" value="deletehost"/>
	<div class="modal fade" id="confirm-delete-host" tabindex="-1" role="dialog" aria-labelledby="ConfirmAction" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="myModalLabel">Jeppers Check</h4>
                </div>
                <div class="modal-body">
                    <p>You are about to delete a host.
                    <p>Do you want to proceed?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger btn-ok">Confirm</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    </form>
    <div class="modal fade" id="confirm-delete-hosts" tabindex="-1" role="dialog" aria-labelledby="ConfirmAction" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="myModalLabel">Jeppers Check</h4>
                </div>
                <div class="modal-body">
                    <p>You are about to delete the selected hosts.
                    <p>Do you want to proceed?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger btn-ok">Confirm</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="confirm-runmodule-hosts" tabindex="-1" role="dialog" aria-labelledby="ConfirmAction" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="myModalLabel">Jeppers Check</h4>
                </div>
                <div class="modal-body">
                    <p>You are about to check default credentials on the selected hosts.
                    <p>Do you want to proceed?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger btn-ok">Confirm</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    <form id="screenshot-host-form" name="screenshot-host-form">
	{% csrf_token %}
	<input type="hidden" class="form-control" name="action" value="screenshothost"/>
	<div class="modal fade" id="confirm-screenshot-host" tabindex="-1" role="dialog" aria-labelledby="ConfirmAction" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="myModalLabel">Jeppers Check</h4>
                </div>
                <div class="modal-body">
                    <p>You are about to screenshot a host.
                    <p>Do you want to proceed?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger btn-ok">Confirm</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    </form>
    <div class="modal fade" id="confirm-screenshot-hosts" tabindex="-1" role="dialog" aria-labelledby="ConfirmAction" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="myModalLabel">Jeppers Check</h4>
                </div>
                <div class="modal-body">
                    <p>You are about to screenshot the selected hosts.
                    <p>Do you want to proceed?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger btn-ok">Confirm</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
	<form id="bulk-form" name="bulk-form">
	{% csrf_token %}
	<div class="modal fade" id="bulk-note-modal" tabindex="-1" role="dialog">
    	<div class="modal-dialog">
 	        <div class="modal-content">
    	        <div class="modal-header">
        	        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            	    <h4 class="modal-title" id="myModalLabel">Bulk Notes</h4>
	            </div>
    	        <div class="modal-body">
        	        <textarea placeholder="Notes..." value="" class="form-control" rows="7" id="bulk-note" name="note"></textarea>
	            </div>
    	        <div class="modal-footer">
        	        <button type="button" class="btn btn-danger btn-ok" id="bulk-note-submit">Submit</button>
            	    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
	            </div>
    	    </div>
    	</div>
	</div>
	
	<div class="row">
	{% load staticfiles %}
	
	{% for host in hosts %}
		{% if host.interfaces_set.all|length_is:"1" %}
			{% if host.Stale %}
			<div class="col-lg-2 col-md-3 col-sm-3 col-xs-4 well" id="{{ host.HostID }}" style="word-wrap: break-word;text-align:left;background-color:#939393">
			{% else %}
			<div class="col-lg-2 col-md-3 col-sm-3 col-xs-4 well" id="{{ host.HostID }}" style="word-wrap: break-word;text-align:left">
			{% endif %}
				
				<ul class="dropdown" style="padding-left:3px;padding-top:2px;float:right">
  					<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button"><span class="glyphicon glyphicon-option-vertical"></span></a>
  					<ul class="dropdown-menu dropdown-menu-right">
  						<li><a href="" data-toggle="modal" data-target="#confirm-screenshot-host" data-host="{{ host.HostID }}" id="screenshot-host-submit">Screenshot Host</a></li>
    					<li><a href="" data-toggle="modal" data-target="#confirm-delete-host" data-host="{{ host.HostID }}" id="delete-host-submit">Delete Host</a></li>
  					</ul>
				</ul>
				
				<input type="checkbox" id="{{ host.HostID }}" value="0" name="{{ host.HostID }}" style="float:right"/>
				{{ host.IP }}&#160{% if host.Reviewed %}<span id="{{ host.HostID}}-check" style="color:green" class="glyphicon glyphicon-ok" aria-hidden="true"></span>{% else %}<span id="{{ host.HostID}}-check" style="color:green;display: none;" class="glyphicon glyphicon-ok" aria-hidden="true"></span>{% endif %}<br>
				{{ host.Hostname }}<br>
			{% for interface in host.interfaces_set.all %}
				<a style="margin-bottom:5px;margin-top:5px" class="thumbnail" id="{{ interface.IntID }}" data-host-id="{{ host.HostID }}" data-module="{% if interface.Module %}True{% else %}False{% endif %}" href="#" data-category="{{ host.Category }}" data-lastseen="{{ host.LastSeen }}" data-rating="{{ host.Rating }}" data-product="{{ interface.Product }}" data-link="viewer/?destination={{ interface.IntID }}" data-image-id="" data-toggle="modal" {% if interface.Type == "url" %} data-title="{{ interface.Url }}" {% else %} data-title="{{ host.IP }}:{{ interface.Port }} ({{ host.Hostname }})" {% endif %} data-note="{{ interface.Notes }}" data-default-creds="{{ interface.DefaultCreds }}" data-http-auth="{{ interface.HttpAuth }}" data-name="{{ interface.Name }}" data-image="{% static interface.ImgLink %}" data-target="#image-gallery" data-reviewed="{{ host.Reviewed }}" data-extlink="{{ interface.Url }}">
					<img class="img-responsive img-rounded center-block" src={% static interface.ImgLink %} alt="Short alt text" style="max-width:150px">
				</a>
				{% if interface.Type == "url" %}
				Url: {{ interface.Url }}<br>
				{% else %}
				Port: {{ interface.Port }}<br>
				{% endif %}
				<a href="viewer?destination={{ interface.IntID }}" target="_blank">Open</a>
			{% endfor %}
			</div>
		{% elif host.interfaces_set.all|length_is:"2" %}
			{% if host.Stale %}
			<div class="col-lg-4 col-md-6 col-sm-6 col-xs-8 well" id="{{ host.HostID }}" style="word-wrap: break-word;text-align:left;background-color:#939393">
			{% else %}
			<div class="col-lg-4 col-md-6 col-sm-6 col-xs-8 well" id="{{ host.HostID }}" style="word-wrap: break-word;text-align:left">
			{% endif %}

				<ul class="dropdown" style="padding-left:3px;padding-top:2px;float:right">
  					<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button"><span class="glyphicon glyphicon-option-vertical"></span></a>
  					<ul class="dropdown-menu dropdown-menu-right">
  						<li><a href="" data-toggle="modal" data-target="#confirm-screenshot-host" data-host="{{ host.HostID }}" id="screenshot-host-submit">Screenshot Host</a></li>
    					<li><a href="" data-toggle="modal" data-target="#confirm-delete-host" data-host="{{ host.HostID }}" id="delete-host-submit">Delete Host</a></li>
  					</ul>
				</ul>
				<input type="checkbox" id="{{ host.HostID }}" value="0" name="{{ host.HostID }}" style="float:right"/>
				{{ host.IP }}&#160{% if host.Reviewed %}<span id="{{ host.HostID}}-check" style="color:green" class="glyphicon glyphicon-ok" aria-hidden="true"></span>{% else %}<span id="{{ host.HostID}}-check" style="color:green;display: none;" class="glyphicon glyphicon-ok" aria-hidden="true"></span>{% endif %}<br>
				{{ host.Hostname }}<br>
			<div class="row">
			{% for interface in host.interfaces_set.all %}
				<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" style="text-align:left">
				<a style="margin-bottom:5px;margin-top:5px" class="thumbnail" id="{{ interface.IntID }}" data-host-id="{{ host.HostID }}" data-module="{% if interface.Module %}True{% else %}False{% endif %}" href="#" data-category="{{ interface.Category }}" data-lastseen="{{ host.LastSeen }}" data-rating="{{ host.Rating }}" data-product="{{ interface.Product }}" data-link="viewer/?destination={{ interface.IntID }}" data-image-id="" data-toggle="modal" {% if interface.Type == "url" %} data-title="{{ interface.Url }}" {% else %} data-title="{{ host.IP }}:{{ interface.Port }} ({{ host.Hostname }})" {% endif %} data-note="{{ interface.Notes }}" data-default-creds="{{ interface.DefaultCreds }}" data-http-auth="{{ interface.HttpAuth }}" data-name="{{ interface.Name }}" data-image="{% static interface.ImgLink %}" data-target="#image-gallery" data-reviewed="{{ host.Reviewed }}" data-extlink="{{ interface.Url }}">
					<img class="img-responsive img-rounded center-block" src={% static interface.ImgLink %} alt="Short alt text" style="max-width:150px">
				</a>
				Port: {{ interface.Port }}<br>
				<a href="viewer?destination={{ interface.IntID }}" target="_blank">Open</a>
				</div>
			{% endfor %}
			</div>
			</div>
		{% elif host.interfaces_set.all|length_is:"3" %}
			{% if host.Stale %}
			<div class="col-lg-6 col-md-9 col-sm-9 col-xs-12 well" id="{{ host.HostID }}" style="word-wrap: break-word;text-align:left;background-color:#939393">
			{% else %}
			<div class="col-lg-6 col-md-9 col-sm-9 col-xs-12 well" id="{{ host.HostID }}" style="word-wrap: break-word;text-align:left">
			{% endif %}

				<ul class="dropdown" style="padding-left:3px;padding-top:2px;float:right">
  					<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button"><span class="glyphicon glyphicon-option-vertical"></span></a>
  					<ul class="dropdown-menu dropdown-menu-right">
  						<li><a href="" data-toggle="modal" data-target="#confirm-screenshot-host" data-host="{{ host.HostID }}" id="screenshot-host-submit">Screenshot Host</a></li>
    					<li><a href="" data-toggle="modal" data-target="#confirm-delete-host" data-host="{{ host.HostID }}" id="delete-host-submit">Delete Host</a></li>
  					</ul>
				</ul>
				<input type="checkbox" id="{{ host.HostID }}" value="0" name="{{ host.HostID }}" style="float:right"/>
				{{ host.IP }}&#160{% if host.Reviewed %}<span id="{{ host.HostID}}-check" style="color:green" class="glyphicon glyphicon-ok" aria-hidden="true"></span>{% else %}<span id="{{ host.HostID}}-check" style="color:green;display: none;" class="glyphicon glyphicon-ok" aria-hidden="true"></span>{% endif %}<br>
				{{ host.Hostname }}<br>
			<div class="row">
			{% for interface in host.interfaces_set.all %}
				<div class="col-lg-4 col-md-4 col-sm-4 col-xs-4" style="word-wrap: break-word;text-align:left">
				<a style="margin-bottom:5px;margin-top:5px" class="thumbnail" id="{{ interface.IntID }}" data-host-id="{{ host.HostID }}" data-module="{% if interface.Module %}True{% else %}False{% endif %}" href="#" data-category="{{ interface.Category }}" data-lastseen="{{ host.LastSeen }}" data-rating="{{ host.Rating }}" data-product="{{ interface.Product }}" data-link="viewer/?destination={{ interface.IntID }}" data-image-id="" data-toggle="modal" {% if interface.Type == "url" %} data-title="{{ interface.Url }}" {% else %} data-title="{{ host.IP }}:{{ interface.Port }} ({{ host.Hostname }})" {% endif %} data-note="{{ interface.Notes }}" data-default-creds="{{ interface.DefaultCreds }}" data-http-auth="{{ interface.HttpAuth }}" data-name="{{ interface.Name }}" data-image="{% static interface.ImgLink %}" data-target="#image-gallery" data-reviewed="{{ host.Reviewed }}" data-extlink="{{ interface.Url }}">
					<img class="img-responsive img-rounded center-block" src={% static interface.ImgLink %} alt="Short alt text" style="max-width:150px">
				</a>
				Port: {{ interface.Port }}<br>
				<a href="viewer?destination={{ interface.IntID }}" target="_blank">Open</a>
				</div>
			{% endfor %}
			</div>
			</div>
		{% elif host.interfaces_set.all.count > 3 %}
			{% if host.Stale %}
			<div class="col-lg-8 col-md-12 col-sm-12 col-xs-12 well" id="{{ host.HostID }}" style="word-wrap: break-word;text-align:left;background-color:#939393">
			{% else %}
			<div class="col-lg-8 col-md-12 col-sm-12 col-xs-12 well" id="{{ host.HostID }}" style="word-wrap: break-word;text-align:left">
			{% endif %}

				<ul class="dropdown" style="padding-left:3px;padding-top:2px;float:right">
  					<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button"><span class="glyphicon glyphicon-option-vertical"></span></a>
  					<ul class="dropdown-menu dropdown-menu-right">
  						<li><a href="" data-toggle="modal" data-target="#confirm-screenshot-host" data-host="{{ host.HostID }}" id="screenshot-host-submit">Screenshot Host</a></li>
    					<li><a href="" data-toggle="modal" data-target="#confirm-delete-host" data-host="{{ host.HostID }}" id="delete-host-submit">Delete Host</a></li>
  					</ul>
				</ul>
				<input type="checkbox" id="{{ host.HostID }}" value="0" name="{{ host.HostID }}" style="float:right"/>
				{{ host.IP }}&#160{% if host.Reviewed %}<span id="{{ host.HostID}}-check" style="color:green" class="glyphicon glyphicon-ok" aria-hidden="true"></span>{% else %}<span id="{{ host.HostID}}-check" style="color:green;display: none;" class="glyphicon glyphicon-ok" aria-hidden="true"></span>{% endif %}<br>
				{{ host.Hostname }}<br>
			<div class="row">
			{% for interface in host.interfaces_set.all %}
				<div class="col-lg-3 col-md-3 col-sm-3 col-xs-3" style="word-wrap: break-word;text-align:left">
				<a style="margin-bottom:5px;margin-top:5px" class="thumbnail" id="{{ interface.IntID }}" data-host-id="{{ host.HostID }}" data-module="{% if interface.Module %}True{% else %}False{% endif %}" href="#" data-category="{{ interface.Category }}" data-lastseen="{{ host.LastSeen }}" data-rating="{{ host.Rating }}" data-product="{{ interface.Product }}" data-link="viewer/?destination={{ interface.IntID }}" data-image-id="" data-toggle="modal" {% if interface.Type == "url" %} data-title="{{ interface.Url }}" {% else %} data-title="{{ host.IP }}:{{ interface.Port }} ({{ host.Hostname }})" {% endif %} data-note="{{ interface.Notes }}" data-default-creds="{{ interface.DefaultCreds }}" data-http-auth="{{ interface.HttpAuth }}" data-name="{{ interface.Name }}" data-image="{% static interface.ImgLink %}" data-target="#image-gallery" data-reviewed="{{ host.Reviewed }}" data-extlink="{{ interface.Url }}">
					<img class="img-responsive img-rounded center-block" src={% static interface.ImgLink %} alt="Short alt text" style="max-width:150px">
				</a>
				Port: {{ interface.Port }}<br>
				<a href="viewer?destination={{ interface.IntID }}" target="_blank">Open</a>
				</div>
			{% endfor %}
			</div>
			</div>
		{% endif %}
	{% endfor %}
	</div>
	</form>
	<!-- Pagination -->
	<nav>
	<div align="center">
		<ul style="margin-bottom:5px" class="pagination" align="center">		
			{% if hosts.has_previous %}
				<li><a href="?page={{ hosts.previous_page_number }}{{ pagination_parameters }}" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
			{% endif %}
			{% if hosts.paginator.num_pages < 12 %}
				{% for page in hosts.paginator.page_range %}
					{% if hosts.number == page %}
						<li class="active"><a href="?page={{ page }}{{ pagination_parameters }}"> {{ page }} <span class="sr-only">(current)</span></a></li>
					{% else %}
						<li><a href="?page={{ page }}{{ pagination_parameters }}"> {{ page }} </a></li>
					{% endif %}
				{% endfor %}
			{% elif hosts.paginator.num_pages > 11 %}
				{% if hosts.number < 7 %}
					{% for page in "nnnnnnnnnnn" %}
						{% if hosts.number == forloop.counter %}
							<li class="active"><a href="?page={{ forloop.counter }}{{ pagination_parameters }}"> {{ forloop.counter }} <span class="sr-only">(current)</span></a></li>
						{% else %}
							<li><a href="?page={{ forloop.counter }}{{ pagination_parameters }}"> {{ forloop.counter }} </a></li>
						{% endif %}
					{% endfor %}
				{% elif hosts.number|add:5 <= hosts.paginator.num_pages %}
					<li><a href="?page={{ hosts.previous_page_number|add:"-4" }}{{ pagination_parameters }}"> {{ hosts.previous_page_number|add:"-4" }} </a></li>
					<li><a href="?page={{ hosts.previous_page_number|add:"-3" }}{{ pagination_parameters }}"> {{ hosts.previous_page_number|add:"-3" }} </a></li>
					<li><a href="?page={{ hosts.previous_page_number|add:"-2" }}{{ pagination_parameters }}"> {{ hosts.previous_page_number|add:"-2" }} </a></li>
					<li><a href="?page={{ hosts.previous_page_number|add:"-1" }}{{ pagination_parameters }}"> {{ hosts.previous_page_number|add:"-1" }} </a></li>
					<li><a href="?page={{ hosts.previous_page_number }}{{ pagination_parameters }}"> {{ hosts.previous_page_number }} </a></li>
					<li class="active"><a href="?page={{ hosts.number }}"> {{ hosts.number }} </a></li>
					<li><a href="?page={{ hosts.next_page_number }}{{ pagination_parameters }}"> {{ hosts.next_page_number }} </a></li>
					<li><a href="?page={{ hosts.next_page_number|add:"1" }}{{ pagination_parameters }}"> {{ hosts.next_page_number|add:"1" }} </a></li>	
					<li><a href="?page={{ hosts.next_page_number|add:"2" }}{{ pagination_parameters }}"> {{ hosts.next_page_number|add:"2" }} </a></li>
					<li><a href="?page={{ hosts.next_page_number|add:"3" }}{{ pagination_parameters }}"> {{ hosts.next_page_number|add:"3" }} </a></li>
					<li><a href="?page={{ hosts.next_page_number|add:"4" }}{{ pagination_parameters }}"> {{ hosts.next_page_number|add:"4" }} </a></li>
				{% elif hosts.number|add:5 > hosts.paginator.num_pages %}
					{% for minus_number in nav_list %}
						{% if hosts.number == hosts.paginator.num_pages|add:minus_number %}
							<li class="active"><a href="?page={{ hosts.paginator.num_pages|add:minus_number }}{{ pagination_parameters }}"> {{ hosts.paginator.num_pages|add:minus_number }} </a></li>
						{% else %}
							<li><a href="?page={{ hosts.paginator.num_pages|add:minus_number }}{{ pagination_parameters }}"> {{ hosts.paginator.num_pages|add:minus_number }} </a></li>
						{% endif %}	
					{% endfor %}
					{% if hosts.paginator.num_pages == hosts.number %}
						<li class="active"><a href="?page={{ hosts.paginator.num_pages }}{{ pagination_parameters }}"> {{ hosts.paginator.num_pages }} </a></li>
					{% else %}
						<li><a href="?page={{ hosts.paginator.num_pages }}{{ pagination_parameters }}"> {{ hosts.paginator.num_pages }} </a></li>
					{% endif %}
				{% endif %}
			{% endif %}
						{% if hosts.has_next %}
								<li><a href="?page={{ hosts.next_page_number }}{{ pagination_parameters }}" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
						{% endif %}

		</ul>
		<div>	
			Page {{ hosts.number }} out of {{ hosts.paginator.num_pages }}<br><br>
		</div>		
	</div>
	</nav>
{% else %}
<div class="well" style="width:70%;margin:0 auto">
	<h3>Kraken doesn't have any data!</h3>
	<p>There is not currently any data to populate this page with. Vists the <a href="{% url 'webscout:setup' %}">Setup Page</a> to ingest data and take screenshots. If you need help, please referece the <a href="https://github.com/Sw4mpf0x/Kraken">Kraken Github page</a> for a more detailed walkthrough</p>
</div>
{% endif %}
</div>

<!-- Screenshot Popup Box -->
<div class="modal fade" id="image-gallery" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog" style="width:70%">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
				<h4 class="modal-title" id="image-gallery-title" align="center"></h4>
			</div>
			<div class="modal-body">
			 	<div class="row">
			 			<div class="well col-md-4">
			 			<div class="alert alert-success" id="gallery-success-alert">
        					<button type="button" class="close" data-dismiss="alert">x</button>
        					<strong>Success!</strong>
        					<span id="gallery-success-text"></span>
						</div>
						<div class="alert alert-warning" id="gallery-warning-alert">
        					<button type="button" class="close" data-dismiss="alert">x</button>
        					<strong>Warning!</strong>
        					<span id="gallery-warning-text"></span>
						</div>
						<div style="padding-bottom:5px"><h3>Interface Information</h3></div>
			 			<div style="padding-bottom:5px"><b>Protocol:</b>&#160<span id="image-gallery-name"></span><br></div>
			 			<div style="padding-bottom:5px"><b>Product:</b>&#160&#160<span id="image-gallery-product"></span><br></div>
			 			<div style="padding-bottom:5px"><b>Category:</b>&#160&#160<span id="image-gallery-category"></span><br></div>
			 			<div style="padding-bottom:5px"><b>Last Seen:</b>&#160&#160<span id="image-gallery-lastseen"></span><br></div>
			 			<div style="padding-bottom:5px"><h3>Documentation</h3></div>
			 			<form id="note-form" method="POST">
							<div class="form-group">
								{% csrf_token %}
  								<input type="hidden" id="image-gallery-default-credshidden" value="No" name="default-creds" />
  								<input type="checkbox" id="image-gallery-default-creds" value="Yes" name="default-creds" />&#160&#160Default Credentials&#160<button data-id="" id="runmodule" style="padding:3px;margin-top:-3px" type="button" class="btn"><span class="glyphicon glyphicon-screenshot"></span></button><br>
  								<input type="hidden" id="image-gallery-http-authhidden" value="No" name="http-auth" />
  								<input type="checkbox" id="image-gallery-http-auth" value="Yes" name="http-auth" />&#160&#160HTTP Authentication<br>
  								<input type="hidden" id="image-gallery-reviewedhidden" value="No" name="reviewed" />
  								<input type="checkbox" id="image-gallery-reviewed" value="Yes" name="reviewed" />&#160&#160Reviewed<br><br>
								<input type="hidden" id="image-gallery-host-id" class="form-control" name="hostid" value=""/>
								<input type="hidden" id="image-gallery-id" class="form-control" name="record" value=""/>
			 					<label for="image-gallery-notes">Notes:</label>
								<textarea placeholder="Notes..." value="" class="form-control" rows="3" id="image-gallery-note" name="note"></textarea>
								<input type="hidden" class="form-control" name="action" value="note"/>
								<button id="note-submit" type="submit" class="btn btn-primary">Submit</button>
							</div>
						</form>
						<script>
							$("#success-alert").hide();
							$("#warning-alert").hide();
							$('a#bulkdelete').click(function(e){
								e.preventDefault();
							});
                            $('a#bulkreviewed').click(function(e){
                                e.preventDefault();
                                $.ajax({
                                    type: 'POST',
                                    url: "",
                                    data: $('form#bulk-form').serialize() + "&action=bulkreviewed",
                                    success: function(data){
                                        $("#success-text").text("Bulk changes submitted.")
                                        $("#success-alert").alert();
                                        $("#success-alert").fadeTo(2000, 500).slideUp(500, function(){
                                            $("#success-alert").hide();
                                        });
                                        console.log(data[0]);
                                        console.log(data[1]);
                                        $.each(data[0], function(index, host){
                                        	console.log('host: '+host);
                                        	$("#"+host+"-check")[0].style.display = 'inline';
                                        });
                                        $.each(data[1], function(index, interface){
                                        	console.log('Int: '+interface);
                                        	$("#"+interface).attr("data-reviewed", "True");
                                        });
                                    },
                                    error: function(){
                                        $("#warning-text").text("A problem was encountered while submitting bulk changes.")
                                        $("#warning-alert").alert();
                                        $("#warning-alert").fadeTo(2000, 500).slideUp(500, function(){
                                            $("#warning-alert").hide();
                                        }); 
                                    },
                                });
                            });
							$(function() {
								if(document.getElementById("image-gallery-default-creds").checked) {
									document.getElementById("image-gallery-default-credshidden").disabled = true;
								}
								if(document.getElementById("image-gallery-http-auth").checked) {
									document.getElementById("image-gallery-http-authhidden").disabled = true;
								}
							//twitter bootstrap script
								$("#gallery-success-alert").hide();
								$("#gallery-warning-alert").hide();
								$("button#note-submit").click(function(e){
									e.preventDefault();
									$.ajax({
										type: "POST",
										url: "",
										data: $('form#note-form').serialize(),
										success: function(msg){
											$("#gallery-success-text").text("Notes updated for this interface.")
											$("#gallery-success-alert").alert();
											$("#gallery-success-alert").fadeTo(2000, 500).slideUp(500, function(){
			   									$("#gallery-success-alert").hide();
			   								});
											$($("#"+$("#image-gallery-id").attr('value'))).attr('data-note', $("#image-gallery-note").val());
											if(document.getElementById("image-gallery-default-creds").checked) {
												$($("#"+$("#image-gallery-id").attr('value'))).attr('data-default-creds', "True");
											}
											else{
												$($("#"+$("#image-gallery-id").attr('value'))).attr('data-default-creds', "False");
											};
											if(document.getElementById("image-gallery-http-auth").checked) {
												$($("#"+$("#image-gallery-id").attr('value'))).attr('data-http-auth', "True");
											}
											else{
												$($("#"+$("#image-gallery-id").attr('value'))).attr('data-http-auth', "False");
											};
											if(document.getElementById("image-gallery-reviewed").checked) {
												$($("#"+$("#image-gallery-id").attr('value'))).attr('data-reviewed', "True");
												$($("#"+$("#image-gallery-host-id").attr('value')+"-check"))[0].style.display = 'inline';
											}
											else{
												$($("#"+$("#image-gallery-id").attr('value'))).attr('data-reviewed', "False");
												$($("#"+$("#image-gallery-host-id").attr('value')+"-check"))[0].style.display = 'none';
											};
										},
										error: function(){
											alert("failure");
										}
								  	});
								});
								$("button#bulk-note-submit").click(function(e){
									e.preventDefault();
									$.ajax({
										type: "POST",
										url: "",
										data: $('form#bulk-form').serialize() + '&action=bulknote',
										success: function(data){
											$("#success-text").text("Bulk changes submitted.")
											$("#success-alert").alert();
											$("#success-alert").fadeTo(2000, 500).slideUp(500, function(){
			   									$("#success-alert").hide();
			   								});
			   								console.log(data);
											$.each(data[1], function(index, interface){
												console.log(interface);
												$("#"+interface).attr('data-note', $("#bulk-note").val());
											});
										},
										error: function(){
											alert("failure");
										}
								  	});
								  	$('#bulk-note-modal').modal('hide');
								});
								$("button#checkall").click(function(){
									if(document.getElementById("flagstone").checked){
										$('#flagstone').prop('checked', false);
										$('#bulk-form input:checkbox').not(this).prop('checked', false);
									}else{
										$('#flagstone').prop('checked', true);
										$('#bulk-form input:checkbox').not(this).prop('checked', true);
									}
    								
								});
								$("button#runmodule").click(function(){
									$.ajax({
										type: "GET",
										url: "runmodule",
										data: "interface=" + $(this).attr('data-id'),
										success: function(data){
											if (data[0] == "Success"){
												$("#gallery-success-text").text("Default credentials worked!")
												$("#gallery-success-alert").alert();
												$("#gallery-success-alert").fadeTo(2000, 500).slideUp(500, function(){
			   										$("#gallery-success-alert").hide();
			   									});
			   									var currentNote = $("#image-gallery-note").val()
			   									$("#image-gallery-note").val('Successfully authenticated with: (' + data[1] + ')\n' + currentNote);
			   									$("#"+$("#image-gallery-id").attr('value')).attr('data-note', 'Successfully authenticated with: (' + data[1] + ')\n' + currentNote);
			   									$("#image-gallery-default-creds").prop("checked", true);
			   									$("#"+$('#image-gallery-id').attr('value')).attr('data-default-creds', "True");
			   									//replace notes with db notes and check default creds box
			   								};
			   								if (data[0] == "Fail"){
			   									$("#gallery-warning-text").text("Default credentials did not work.")
												$("#gallery-warning-alert").alert();
												$("#gallery-warning-alert").fadeTo(2000, 500).slideUp(500, function(){
			   										$("#gallery-warning-alert").hide();
			   									});
			   								};
										},
										error: function(){
											alert("failure");
										}
								  	});
    								
								});
                                $('#confirm-delete-host').on('click', '.btn-ok', function(e) {
                                    var $modalDiv = $(e.delegateTarget);
                                    var host = $(this).data('host');
                                    console.log("Host: "+ host);
                                    $.ajax({
                                        type: 'POST',
                                        url: "",
                                        data: $('form#delete-host-form').serialize() + '&host=' + host,
                                        success: function(data){
                                            $("#success-text").text("Request to delete host submitted.")
                                            $("#success-alert").alert();
                                            $("#success-alert").fadeTo(2000, 500).slideUp(500, function(){
                                                $("#success-alert").hide();
                                            });
                                            $.each(data, function(index, host){
                    							console.log(host);
                    							$("div#" + host).remove();
                							});
                                        },
                                        error: function(){
                                            $("#warning-text").text("A problem was encountered while submitting your request to delete a host.")
                                            $("#warning-alert").alert();
                                            $("#warning-alert").fadeTo(2000, 500).slideUp(500, function(){
                                                $("#warning-alert").hide();
                                            }); 
                                        },
                                    })
                                    $modalDiv.addClass('loading');
                                    setTimeout(function() {
                                        $modalDiv.modal('hide').removeClass('loading');
                                    }, 1000)
                                });
                            
                                $('#confirm-delete-host').on('show.bs.modal', function(e) {
                                    var data = $(e.relatedTarget).data();
                                    $('.title', this).text(data.description);
                                    $('.btn-ok', this).data('host', data.host);
                                });
                                $('#confirm-delete-hosts').on('click', '.btn-ok', function(e) {
                                    var $modalDiv = $(e.delegateTarget);
                                    var host = $(this).data('host');
                                    console.log("Host: "+ host);
                                    $.ajax({
										type: "POST",
										url: "",
										data: $('form#bulk-form').serialize() + '&action=bulkdelete',
										success: function(data){
											$("#success-text").text("Request to delete selected hosts submitted.")
											$("#success-alert").alert();
											$("#success-alert").fadeTo(2000, 500).slideUp(500, function(){
			   									$("#success-alert").hide();
			   								});
			   								console.log(data);
											$.each(data[0], function(index, host){
												console.log(host);
												$("div#"+host).remove()
											});
										},
										error: function(){
											alert("A problem was encountered while submitting your request to delete a host.");
										}
								  	});
                                    $modalDiv.addClass('loading');
                                    setTimeout(function() {
                                        $modalDiv.modal('hide').removeClass('loading');
                                    }, 1000)
                                });
								$('#confirm-runmodule-hosts').on('click', '.btn-ok', function(e) {
                                    var $modalDiv = $(e.delegateTarget);
                                    var host = $(this).data('host');
                                    console.log("Host: "+ host);
                                    $.ajax({
										type: "POST",
										url: "",
										data: $('form#bulk-form').serialize() + '&action=bulkrunmodule',
										success: function(data){
											$("#success-text").text("Request to check default credentials on selected hosts submitted.")
											$("#success-alert").alert();
											$("#success-alert").fadeTo(2000, 500).slideUp(500, function(){
			   									$("#success-alert").hide();
			   								});
			   								console.log(data);
											$.each(data[0], function(index, host){
												console.log(host);
												$("div#"+host).remove()
											});
										},
										error: function(){
											alert("A problem was encountered while submitting your request to check default credentials on a host.");
										}
								  	});
                                    $modalDiv.addClass('loading');
                                    setTimeout(function() {
                                        $modalDiv.modal('hide').removeClass('loading');
                                    }, 1000)
                                });
								$('#confirm-screenshot-host').on('click', '.btn-ok', function(e) {
                                    var $modalDiv = $(e.delegateTarget);
                                    var host = $(this).data('host');
                                    console.log("Host: "+ host);
                                    $.ajax({
                                        type: 'POST',
                                        url: "",
                                        data: $('form#screenshot-host-form').serialize() + '&host=' + host,
                                        success: function(data){
                                            $("#success-text").text("Request to screenshot host submitted.")
                                            $("#success-alert").alert();
                                            $("#success-alert").fadeTo(2000, 500).slideUp(500, function(){
                                                $("#success-alert").hide();
                							});
                                        },
                                        error: function(){
                                            $("#warning-text").text("A problem was encountered while submitting your request to screenshot a host.")
                                            $("#warning-alert").alert();
                                            $("#warning-alert").fadeTo(2000, 500).slideUp(500, function(){
                                                $("#warning-alert").hide();
                                            }); 
                                        },
                                    })
                                    $modalDiv.addClass('loading');
                                    setTimeout(function() {
                                        $modalDiv.modal('hide').removeClass('loading');
                                    }, 1000)
                                });
                            
                                $('#confirm-screenshot-host').on('show.bs.modal', function(e) {
                                    var data = $(e.relatedTarget).data();
                                    $('.title', this).text(data.description);
                                    $('.btn-ok', this).data('host', data.host);
                                });
								$('#confirm-screenshot-hosts').on('click', '.btn-ok', function(e) {
                                    var $modalDiv = $(e.delegateTarget);
                                    var host = $(this).data('host');
                                    console.log("Host: "+ host);
                                    $.ajax({
										type: "POST",
										url: "",
										data: $('form#bulk-form').serialize() + '&action=bulkscreenshot',
										success: function(data){
											$("#success-text").text("Request to screenshot selected hosts submitted.")
											$("#success-alert").alert();
											$("#success-alert").fadeTo(2000, 500).slideUp(500, function(){
			   									$("#success-alert").hide();
			   								});
										},
										error: function(){
											alert("Failed to screenshot selected hosts. Check /var/log/apache2/error.log.");
										}
								  	});
                                    $modalDiv.addClass('loading');
                                    setTimeout(function() {
                                        $modalDiv.modal('hide').removeClass('loading');
                                    }, 1000)
                                });
                            
                                $('#confirm-delete-hosts').on('show.bs.modal', function(e) {
                                    var data = $(e.relatedTarget).data();
                                });
							});
						</script>
			 		</div>	
					<div class="well col-md-8">
						<img id="image-gallery-image" class="img-responsive" src="">
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<div class="row">
					<div class="col-md-2">
						<button type="button" class="btn btn-primary" id="show-previous-image" style="width:100%;">Previous</button>
					</div>

					<div class="col-md-2 text-justify">
					</div>

					<div class="col-md-4 text-justify" style="text-align: center">
						<div class="btn-group" role="group">
							<a href="" id="image-gallery-extlink" style="text-align:left" target="_blank"><button type="button" class="btn btn-primary">Open</button></a>
							<a href="" id="image-gallery-link" style="text-align:left" target="_blank"><button type="button" class="btn btn-primary" >KrakenView</button></a>
						</div>
					</div>

					<div class="col-md-2 text-justify">
					</div>

					<div class="col-md-2">
						<button type="button" id="show-next-image" class="btn btn-primary" style="width:100%;">Next</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}
